
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>deviceorientation</title>
        <meta charset="utf-8">
        <meta name="viewport" content="user-scalable=no, initial-scale=1">
        <style>
            body {
                margin: 0px;
                background-color: #000000;
                overflow: hidden;
            }
            #header {
                position: absolute;
                top: 0px; width: 100%;
                color: #ffffff;
                padding: 5px;
                font-family:Monospace;
                font-size:13px;
                font-weight: bold;
                text-align:center;
                box-sizing: border-box;
            }
            
            #Main {
                position: absolute;
                top: 100px; width: 100%;
                color: #ffffff;
                padding: 5px;
                font-family:Monospace;
                font-size:13px;
                font-weight: bold;
                text-align:center;
                box-sizing: border-box;
            }
            a {
                color: #ff8800;
            }
        </style>
    </head>
    <body>
	    <div id = "container">
        
            <div id="header">

            </div>
            /*
            <div id="Main">
                <h3>main message </h2>
                <h2>Submit Button</h2>
                <p>The <strong>input type="submit"</strong> defines a button for submitting form data to a form-handler:</p>
		   <button onclick="StartGamefunction()">Click me</button>
		
/*
                <form action="/action_page.php">
                First name:<br>
                <input type="text" name="firstname" value="Mickey">
                <br>
                Last name:<br>
                <input type="text" name="lastname" value="Mouse">
                <br><br>
                <input type="button" value="start">
                </form>
                <p>If you click "Submit", the form-data will be sent to a page called "/action_page.php".</p>
*/		    
		    
		    
		    
		    
            </div>
            */
        </div>
        
	    
	    
	    
        <script src="build/three.js"></script>
        <script src="js/controls/DeviceOrientationControls.js"></script>
        <script src="js/WebGL.js"></script>
    <script src="js/threex.domevents.js"></script>
    <script src="js/TweenMax.min.js"></script>
        <video id="video" autoplay style="display:none"></video>
        
        <script>
		var StartGame = false;
		function StartGamefunction(){
			StartGame = true;
		}		
		
		
		
		
            if ( WEBGL.isWebGLAvailable() === false ) {
                document.body.appendChild( WEBGL.getWebGLErrorMessage() );
            }
            if(StartGame == true){
	    	init();
            	animate();
		    
	    	var domEvents = new THREEx.DomEvents(camera, renderer.domElement);
	    	domEvents.addEventListener(planemesh , 'touchstart' , event =>{
            		this.t1 = new TimelineMax();
            		this.t1.to(planemesh.scale, 0.5 , { x:0 , y:0 , z:0 , ease:Expo.easeOut});
            	})
	    	domEvents.addEventListener(planemesh2 , 'touchstart' , event =>{
           		this.t2 = new TimelineMax();
            		this.t2.to(planemesh2.scale, 0.5 , { x:0 , y:0 , z:0 , ease:Expo.easeOut});
        	})
	    }
		
            var camera, scene, renderer, controls ,video;
            
            function init() {
                camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 1100 );
                controls = new THREE.DeviceOrientationControls( camera );
                scene = new THREE.Scene();
                video = document.getElementById( 'video' );
                var texture = new THREE.VideoTexture( video );
                
                scene.background = texture;
/*
                var helperGeometry = new THREE.BoxBufferGeometry( 100, 100, 100, 4, 4, 4 );
                var helperMaterial = new THREE.MeshBasicMaterial( { color: 0xff00ff, wireframe: true } );
                var helper = new THREE.Mesh( helperGeometry, helperMaterial );
            helper.position.set( 0, 0, 0 );
                scene.add( helper );
  */              
        var texture = new THREE.TextureLoader().load( 'textures/fish.png' );
        var geometry = new THREE.PlaneGeometry( 50,50);
        var material = new THREE.MeshBasicMaterial( { map: texture } );
        planemesh = new THREE.Mesh( geometry, material );
        planemesh.rotation.y = 90 ;
        planemesh.position.set( -100, 0, 0 );
        scene.add( planemesh );
                
        var texture = new THREE.TextureLoader().load( 'textures/fish.png' );
        var geometry = new THREE.PlaneGeometry( 50,50);
        var material = new THREE.MeshBasicMaterial( { map: texture } );
        planemesh2 = new THREE.Mesh( geometry, material );
        planemesh2.rotation.y = 90 ;
        planemesh2.position.set( -100, 50, 0 );
        scene.add( planemesh2 );
            
            
                /* textingbox
            var texture = new THREE.TextureLoader().load( 'textures/fish.png' );
            var geometry = new THREE.BoxBufferGeometry( 20, 20, 20 );
            var material = new THREE.MeshBasicMaterial( { map: texture } );
            boxmesh = new THREE.Mesh( geometry, material );
            boxmesh.position.set( -100, 0, 0 );
            scene.add( boxmesh );
        */
            
                //
                renderer = new THREE.WebGLRenderer( { antialias: true } );
                renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( window.innerWidth, window.innerHeight );
                document.body.appendChild( renderer.domElement );
                //
                window.addEventListener( 'resize', onWindowResize, false );
                            
                if ( navigator.mediaDevices && navigator.mediaDevices.getUserMedia ) {
                    var constraints = {
                        video: {
                            //width: 1280, height: 720, facingMode: "user" //使用前鏡頭
                            width: 1280, height: 720, facingMode: { exact: "environment" }//使用後鏡頭
                        }
                    };
                    navigator.mediaDevices.getUserMedia( constraints ).then(
                        function ( stream ) {    
                        // apply the stream to the video element used in the texture
                        video.srcObject = stream;
                        video.play();
                        } ).catch( function ( error ) {
                            console.error( 'Unable to access the camera/webcam.', error );
                    } );
                } else {
                    console.error( 'MediaDevices interface not available.' );
                }
            
                
            }

        
        
       
        
        
            function animate() {
                window.requestAnimationFrame( animate );
                controls.update();
                renderer.render( scene, camera );
            }
            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize( window.innerWidth, window.innerHeight );
            }
        </script>
    </body>
</html>
